<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Introvert Event App</title>
<style>
/* ==== YOUR ORIGINAL DESIGN (UNCHANGED) ==== */
:root {
  --bg: #f7faff;
  --card: #ffffff;
  --text: #1a1f36;
  --muted: #6b7a99;
  --primary: #4c8bf5;
  --accent: #dbe8ff;
}
body {
  margin: 0;
  font-family: Inter, sans-serif;
  background: var(--bg);
  color: var(--text);
}
.topbar {
  display: flex;
  justify-content: space-between;
  padding: 14px 22px;
  background: var(--card);
  box-shadow: 0 2px 4px rgba(0,0,0,0.04);
  position: sticky;
  top:0;
  z-index: 20;
}
.btn {background: var(--primary);color:#fff;padding:8px 16px;border-radius:7px;border:none;cursor:pointer;}
.btn.ghost {background:transparent;color:var(--primary);} 
.hero {width:100%;height:260px;border-radius:16px;overflow:hidden;position:relative;background:#eef4fb;margin-bottom:24px;}
.hero img {width:100%;height:100%;object-fit:cover;}
.hero-arrow{position:absolute;top:50%;transform:translateY(-50%);font-size:30px;cursor:pointer;padding:10px;color:#fff;text-shadow:0 2px 6px rgba(0,0,0,0.55);} 
#heroPrev{left:10px;} #heroNext{right:10px;} 
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;} 
.card{background:var(--card);border-radius:14px;padding:12px;box-shadow:0 1px 3px rgba(0,0,0,0.06);} 
.card img{width:100%;height:150px;object-fit:cover;border-radius:10px;} 
.card h3{margin:6px 0 4px;font-size:16px;font-weight:600;} 
.card p{margin:0;color:var(--muted);font-size:13px;} 
.card small{font-size:12px;color:var(--muted);} 
.delete-btn{margin-top:8px;background:#ff4d4d;color:white;width:100%;padding:6px;border-radius:6px;border:none;cursor:pointer;} 
.modal-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.35);display:none;align-items:center;justify-content:center;z-index:100;} 
.modal{background:var(--card);padding:20px;border-radius:14px;width:90%;max-width:360px;} 
input,textarea,select{width:100%;padding:8px;border:1px solid #eef4fb;border-radius:8px;margin-bottom:10px;} 
</style>
</head>
<body>

<!-- ================= TOP BAR ================= -->
<div class="topbar">
  <div id="userName">User</div>
  <div style="display:flex;gap:16px;align-items:center;">
    <button class="btn ghost" id="btnLogin">Login</button>
    <button class="btn" id="btnUpload">Upload Event</button>
  </div>
</div>

<div style="padding:20px;max-width:900px;margin:auto;">

  <!-- ================= HERO ================= -->
  <div class="hero">
    <div id="heroEmpty" style="display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:var(--muted);font-size:15px;">No ongoing events yet</div>
    <img id="heroImg" style="display:none;" />
    <div id="heroCaption" style="position:absolute;bottom:12px;left:12px;background:rgba(0,0,0,0.4);color:white;padding:6px 12px;border-radius:6px;font-size:14px;max-width:80%;"></div>
    <div id="heroPrev" class="hero-arrow">❮</div>
    <div id="heroNext" class="hero-arrow">❯</div>
  </div>

  <!-- ================= RECOMMENDED ================= -->
  <div style="font-weight:700;font-size:17px;margin:14px 0 8px;">Recommended Events</div>
  <div id="recommendedGrid" class="grid"></div>

  <!-- ================= PREVIOUS EVENTS ================= -->
  <div style="font-weight:700;font-size:17px;margin:28px 0 8px;" class="previous-title">Previous Events</div>
  <div id="previousList"></div>

</div>

<div id="modalBackdrop" class="modal-backdrop"></div>

<!-- ================================================= -->
<!-- =============== FULL JAVASCRIPT ================= -->
<!-- ================================================= -->
<script>
// Persistent state
const saved = localStorage.getItem("introvertEvents");
const state = saved ? JSON.parse(saved) : { ongoing: [], recommended: [], previous: [], user: null };
function save(){ localStorage.setItem("introvertEvents", JSON.stringify(state)); }

const heroImg = document.getElementById('heroImg');
const heroCaption = document.getElementById('heroCaption');
const heroEmpty = document.getElementById('heroEmpty');
const heroPrev = document.getElementById('heroPrev');
const heroNext = document.getElementById('heroNext');
let heroIndex = 0;

function uid(x){ return x + Math.random().toString(36).slice(2,10); }

/* ========== RENDER HERO ========== */
function renderHero(){
  const ongoing = state.ongoing;
  if(ongoing.length===0){ heroEmpty.style.display='flex'; heroImg.style.display='none'; heroCaption.textContent=''; return; }
  heroEmpty.style.display='none';
  heroImg.style.display='block';
  heroIndex = (heroIndex + ongoing.length) % ongoing.length;
  const e = ongoing[heroIndex];
  heroImg.src = e.image;
  heroCaption.textContent = e.title;
}

/* ========== DELETE EVENT ========== */
function deleteEvent(id){
  state.ongoing = state.ongoing.filter(e=>e.id!==id);
  state.recommended = state.recommended.filter(e=>e.id!==id);
  state.previous = state.previous.filter(e=>e.id!==id);
  save();
  renderHero(); renderRecommended(); renderPrevious();
}

/* ========== RENDER RECOMMENDED ========== */
function renderRecommended(){
  const wrap=document.getElementById('recommendedGrid');
  wrap.innerHTML='';
  state.recommended.forEach(ev=>{
    const d=document.createElement('div');
    d.className='card';
    d.innerHTML = `
      <img src="${ev.image}">
      <h3>${ev.title}</h3>
      <p>${ev.desc}</p>
      <small>${ev.category}</small>
      <button class="delete-btn" onclick="deleteEvent('${ev.id}')">Delete</button>
    `;
    wrap.appendChild(d);
  });
}

/* ========== RENDER PREVIOUS ========== */
function renderPrevious(){
  const wrap=document.getElementById('previousList');
  wrap.innerHTML='';
  state.previous.forEach(ev=>{
    const d=document.createElement('div');
    d.className='card';
    d.style.marginBottom='12px';
    d.innerHTML = `
      <img src="${ev.image}">
      <h3>${ev.title}</h3>
      <p>${ev.desc}</p>
      <small>${ev.category}</small>
      <button class="delete-btn" onclick="deleteEvent('${ev.id}')">Delete</button>
    `;
    wrap.appendChild(d);
  });
}

/* ========== UPLOAD MODAL ========== */
const modalBackdrop = document.getElementById('modalBackdrop');
document.getElementById('btnUpload').addEventListener('click',()=>{
  if(!state.user){ alert('Please login first.'); return; }
  modalBackdrop.innerHTML = `
  <div class="modal">
    <h3 style="margin-top:0">Upload Event</h3>
    <input id="title" placeholder="Title">
    <input id="image" placeholder="Image URL">
    <textarea id="desc" placeholder="Description"></textarea>
    <input id="cat" placeholder="Category">
    <select id="status">
      <option value="ongoing">Ongoing</option>
      <option value="previous">Previous</option>
    </select>
    <button class="btn" id="submitEv">Submit</button>
    <button class="btn ghost" id="close">Close</button>
  </div>`;
  modalBackdrop.style.display='flex';

  document.getElementById('close').onclick = ()=>{
    modalBackdrop.style.display='none'; modalBackdrop.innerHTML='';
  };

  document.getElementById('submitEv').onclick = ()=>{
    const title=document.getElementById('title').value.trim();
    if(!title){ alert('Title required'); return; }
    const ev={ id:uid('ev'), title, image:document.getElementById('image').value.trim(), desc:document.getElementById('desc').value.trim(), category:document.getElementById('cat').value.trim(), created_at:new Date().toISOString() };
    const s=document.getElementById('status').value;
    if(s==='ongoing'){ state.ongoing.push(ev); state.recommended.push(ev);} else state.previous.push(ev);
    save();
    modalBackdrop.style.display='none'; modalBackdrop.innerHTML='';
    renderHero(); renderRecommended(); renderPrevious();
  };
});

/* ========== LOGIN ========== */
document.getElementById('btnLogin').addEventListener('click',()=>{
  modalBackdrop.innerHTML = `
  <div class="modal">
    <h3 style="margin-top:0">Login</h3>
    <input id="loginName" placeholder="Your name">
    <button class="btn" id="loginSubmit">Login</button>
    <button class="btn ghost" id="closeLogin">Close</button>
  </div>`;
  modalBackdrop.style.display='flex';

  document.getElementById('closeLogin').onclick = ()=>{
    modalBackdrop.style.display='none'; modalBackdrop.innerHTML='';
  };

  document.getElementById('loginSubmit').onclick = ()=>{
    const n=document.getElementById('loginName').value.trim();
    if(!n){ alert('Enter name'); return; }
    state.user={name:n};
    save();
    document.getElementById('userName').textContent=n;
    modalBackdrop.style.display='none'; modalBackdrop.innerHTML='';
  };
});

/* ========== ARROWS + INIT ========== */
heroPrev.onclick=()=>{ heroIndex--; renderHero(); };
heroNext.onclick=()=>{ heroIndex++; renderHero(); };

if(state.user) document.getElementById('userName').textContent = state.user.name;
renderHero(); renderRecommended(); renderPrevious();
</script>
</body>
</html>
